- name: Prepare random number
  set_fact:
<<<<<<< HEAD
    rpfx: "{{ resource_group | hash('md5') | truncate(7, True, '') }}{{ 1000 | random }}"
  run_once: yes

- name: Call REST API - StorageAccounts_Create
  azure_rm_resource:
    api_version: '2017-10-01'
    resource_group: "{{ resource_group }}"
    provider: storage
    resource_type: storageaccounts
    resource_name: stacc{{ rpfx }}
    body:
      sku:
        name: Standard_LRS
      kind: BlobStorage
      location: eastus
      properties:
        accessTier: Hot
=======
    nsgname: "{{ resource_group | hash('md5') | truncate(7, True, '') }}{{ 1000 | random }}"
  run_once: yes

- name: Call REST API
  azure_rm_resource:
    api_version: '2018-02-01'
    resource_group: "{{ resource_group }}"
    provider: network
    resource_type: networksecuritygroups
    resource_name: "{{ nsgname }}"
    body:
      location: eastus
>>>>>>> 2ecf1d35d3c6b446a4404e3df95c9d888c9cafde
    idempotency: yes
  register: output

- name: Assert that something has changed
  assert:
    that: output.changed

<<<<<<< HEAD
- name: Call REST API - StorageAccounts_Create - with same parameters
  azure_rm_resource:
    api_version: '2017-10-01'
    resource_group: "{{ resource_group }}"
    provider: storage
    resource_type: storageaccounts
    resource_name: stacc{{ rpfx }}
    body:
      sku:
        name: Standard_LRS
      kind: BlobStorage
      location: eastus
      properties:
        accessTier: Hot
=======
- name: Call REST API
  azure_rm_resource:
    api_version: '2018-02-01'
    resource_group: "{{ resource_group }}"
    provider: network
    resource_type: networksecuritygroups
    resource_name: "{{ nsgname }}"
    body:
      location: eastus
>>>>>>> 2ecf1d35d3c6b446a4404e3df95c9d888c9cafde
    idempotency: yes
  register: output

- name: Assert that nothing has changed
  assert:
    that: not output.changed

<<<<<<< HEAD
- name: Call REST API - StorageAccounts_Create - with different parameters
  azure_rm_resource:
    api_version: '2017-10-01'
    resource_group: "{{ resource_group }}"
    provider: storage
    resource_type: storageaccounts
    resource_name: stacc{{ rpfx }}
    body:
      sku:
        name: Standard_LRS
      kind: BlobStorage
      location: eastus
      properties:
        accessTier: Cool
=======
- name: Call REST API
  azure_rm_resource:
    api_version: '2018-02-01'
    resource_group: "{{ resource_group }}"
    provider: network
    resource_type: networksecuritygroups
    resource_name: "{{ nsgname }}"
    body:
      location: eastus
      tags:
        a: "abc"
        b: "cde"
>>>>>>> 2ecf1d35d3c6b446a4404e3df95c9d888c9cafde
    idempotency: yes
  register: output

- name: Assert that something has changed
  assert:
    that: output.changed


- name: Try to get information about account
  azure_rm_resource_facts:
<<<<<<< HEAD
    api_version: '2017-10-01'
    resource_group: "{{ resource_group }}"
    provider: storage
    resource_type: storageaccounts
    resource_name: stacc{{ rpfx }}
=======
    api_version: '2018-02-01'
    resource_group: "{{ resource_group }}"
    provider: network
    resource_type: networksecuritygroups
    resource_name: "{{ nsgname }}"
>>>>>>> 2ecf1d35d3c6b446a4404e3df95c9d888c9cafde
  register: output
